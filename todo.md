### TODOS
- Change all chans into <- in parameters